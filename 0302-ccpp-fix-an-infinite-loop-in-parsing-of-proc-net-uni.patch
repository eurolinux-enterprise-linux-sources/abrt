From 5283f08d11c16731ce25346d7e73a2e7d4b79850 Mon Sep 17 00:00:00 2001
From: Jakub Filak <jfilak@redhat.com>
Date: Fri, 12 Jun 2015 14:27:48 +0200
Subject: [ABRT PATCH] ccpp: fix an infinite loop in parsing of /proc/net/unix

ferror() does not necessarily indicate EOF

Resolves: #1199261

Signed-off-by: Jakub Filak <jfilak@redhat.com>
---
 src/hooks/abrt-hook-ccpp.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/hooks/abrt-hook-ccpp.c b/src/hooks/abrt-hook-ccpp.c
index c1f9078..c847ee9 100644
--- a/src/hooks/abrt-hook-ccpp.c
+++ b/src/hooks/abrt-hook-ccpp.c
@@ -618,7 +618,7 @@ static char *get_dev_log_socket_inode(void)
 
     char *socket_inode = NULL;
     long inode_pos = 0;
-    while (ferror(fpnu) == 0)
+    while (feof(fpnu) == 0 && ferror(fpnu) == 0)
     {
         int field = 0;
         while ((c = fgetc(fpnu)) != EOF && c != '\n')
-- 
1.8.3.1

