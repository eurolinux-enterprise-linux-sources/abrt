From 00ad96aebccb09ef6491f6dfb1bef919a5376d86 Mon Sep 17 00:00:00 2001
From: Nikola Pajkovsky <npajkovs@redhat.com>
Date: Thu, 8 Mar 2012 16:30:18 +0100
Subject: [PATCH 058/105] handle-event: fix blaming dump-dir its self as
 duplicate

all it was happened only due to trailing '/'

Signed-off-by: Nikola Pajkovsky <npajkovs@redhat.com>
---
 src/daemon/abrt-handle-event.c | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/src/daemon/abrt-handle-event.c b/src/daemon/abrt-handle-event.c
index 5d22cf0..58c4a84 100644
--- a/src/daemon/abrt-handle-event.c
+++ b/src/daemon/abrt-handle-event.c
@@ -424,10 +424,15 @@ int main(int argc, char **argv)
     load_abrt_conf();
 
     bool post_create = (strcmp(event_name, "post-create") == 0);
-    const char *dump_dir_name = NULL;
+    char *dump_dir_name = NULL;
     while (*argv)
     {
-        dump_dir_name = *argv++;
+        dump_dir_name = xstrdup(*argv++);
+        int i = strlen(dump_dir_name);
+        while (--i >= 0)
+            if (dump_dir_name[i] != '/')
+                break;
+        dump_dir_name[++i] = '\0';
 
         struct dump_dir *dd = dd_opendir(dump_dir_name, /*flags:*/ 0);
         if (!dd)
-- 
1.7.11.2

